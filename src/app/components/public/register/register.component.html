<div class="register-container">
    <mat-card class="register-card">
        <mat-card-header class="text-center">
            <mat-card-title class="register-title">Registro</mat-card-title>
        </mat-card-header>

        <mat-card-content>
            <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
                <!-- Nombre -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Nombre</mat-label>
                    <input matInput formControlName="nombre" placeholder="Ingresa tu nombre" />
                    <mat-error
                        *ngIf="registerForm.get('nombre')?.hasError('required') && registerForm.get('nombre')?.touched">
                        El nombre es obligatorio.
                    </mat-error>
                    <mat-error
                        *ngIf="registerForm.get('nombre')?.hasError('minlength') || registerForm.get('nombre')?.hasError('maxlength')">
                        El nombre debe tener entre 3 y 15 caracteres.
                    </mat-error>
                </mat-form-field>

                <!-- Email -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Correo Electrónico</mat-label>
                    <input matInput formControlName="email" type="email" placeholder="Ingresa tu correo electrónico" />
                    <mat-error *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
                        Ingresa un correo electrónico válido.
                    </mat-error>
                </mat-form-field>

                <!-- Teléfono -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Teléfono</mat-label>
                    <input matInput formControlName="telefono" type="tel" placeholder="Ingresa tu número de teléfono"
                        maxlength="10" />
                    <mat-error *ngIf="registerForm.get('telefono')?.invalid && registerForm.get('telefono')?.touched">
                        Ingresa un teléfono válido de 10 dígitos númericos.
                    </mat-error>
                </mat-form-field>

                <!-- Contraseña -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Contraseña</mat-label>
                    <input matInput [type]="hide ? 'password' : 'text'" formControlName="password"
                           placeholder="Ingresa tu contraseña"
                           (input)="onPasswordChange(registerForm.get('password')?.value)" required />
                    <button mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Mostrar/ocultar contraseña'" type="button">
                      <mat-icon>{{ hide ? 'visibility' : 'visibility_off' }}</mat-icon>
                    </button>
                  </mat-form-field>
                  

                <!-- Barra de fortaleza de la contraseña -->
                <mat-progress-bar *ngIf="passwordStrength" mode="determinate" [value]="passwordStrengthValue"
                    [color]="passwordStrengthColor"></mat-progress-bar>

                <!-- Confirmación de Contraseña -->
                <mat-form-field appearance="outline" class="full-width">
                    <mat-label>Confirma tu Contraseña</mat-label>
                    <input matInput [type]="hide ? 'password' : 'text'" formControlName="confirmPassword"
                        placeholder="Confirma tu contraseña" required/>
                    <button mat-icon-button matSuffix (click)="hide = !hide"
                        [attr.aria-label]="'Mostrar/ocultar contraseña'" [attr.aria-pressed]="!hide">
                        <mat-icon>{{ hide ? 'visibility' : 'visibility_off' }}</mat-icon>
                    </button>
                    <mat-error *ngIf="registerForm.get('confirmPassword')?.hasError('required')">
                        Este campo es obligatorio.
                      </mat-error>
                      <mat-error *ngIf="registerForm.hasError('mismatch') && registerForm.get('confirmPassword')?.touched">
                        Las contraseñas no coinciden.
                      </mat-error>                      
                </mat-form-field>

                <!-- Submit Button -->
                <div class="actions">
                    <button mat-button class="full-width" type="submit" [disabled]="registerForm.invalid || passwordStrengthValue !== 100 || registerForm.hasError('mismatch') || !registerForm.get('confirmPassword')?.value" >
                        Registrarse
                      </button>                     
                </div>
            </form>

            <div class="footer text-center">
                ¿Tienes una cuenta? <a href="/login">Accede aquí</a>
            </div>
        </mat-card-content>
    </mat-card>
</div>